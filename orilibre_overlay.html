<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>é³´çŸ³ãƒ†ãƒ¬ã‚¤ãƒ³ - OriLibre + æ¤ç”Ÿè§£æ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://unpkg.com/maplibre-gl@4.1.2/dist/maplibre-gl.css" rel="stylesheet" />
    <script src="https://unpkg.com/maplibre-gl@4.1.2/dist/maplibre-gl.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }

        .controls {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            max-width: 280px;
        }

        .controls h1 {
            font-size: 14px;
            margin-bottom: 10px;
        }

        .controls label {
            display: flex;
            align-items: center;
            font-size: 12px;
            margin: 5px 0;
            cursor: pointer;
        }

        .controls input[type="checkbox"] {
            margin-right: 8px;
        }

        .controls input[type="range"] {
            width: 120px;
            margin-left: 10px;
        }

        .controls small {
            color: #666;
            font-size: 10px;
        }

        .legend {
            position: absolute;
            bottom: 30px;
            right: 10px;
            background: rgba(255, 255, 255, 0.95);
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            font-size: 11px;
            z-index: 1000;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 3px 0;
        }

        .legend-color {
            width: 20px;
            height: 14px;
            margin-right: 6px;
            border: 1px solid #ccc;
            border-radius: 2px;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <div class="controls">
        <h1>ğŸŒ² é³´çŸ³ æ¤ç”Ÿè§£æã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤</h1>
        <label>
            <input type="checkbox" id="toggleVegetation" checked>
            æ¤ç”Ÿãƒ¬ã‚¤ãƒ¤è¡¨ç¤º
        </label>
        <label>
            é€æ˜åº¦:
            <input type="range" id="opacitySlider" min="0" max="100" value="60">
        </label>
        <hr style="margin: 10px 0; border: none; border-top: 1px solid #ddd;">
        <small>å‡ºå…¸ï¼šå±±æ¢¨çœŒç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿ï¼ˆ2024ï¼‰CC BY 4.0</small>
    </div>

    <div class="legend">
        <strong>èµ°è¡Œå¯èƒ½åº¦</strong>
        <div class="legend-item">
            <div class="legend-color" style="background: #FFFFFF;"></div>è‰¯å¥½
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #CEF7BB;"></div>ã‚„ã‚„é…ã„
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #9DF076;"></div>å›°é›£
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #60E520;"></div>éå¸¸ã«å›°é›£
        </div>
    </div>

    <script>
        // é³´çŸ³ãƒ†ãƒ¬ã‚¤ãƒ³ã®ä¸­å¿ƒåº§æ¨™
        const CENTER = [138.378, 35.878];

        // OriLibreã®æ—¥æœ¬ã‚¹ã‚¿ã‚¤ãƒ«JSON URL
        const ORILIBRE_STYLE = 'https://raw.githubusercontent.com/tjmsy/isomizer-projectfiles/refs/heads/main/projects/isomized-japan/generated-style.json';

        // æ¤ç”Ÿã‚¿ã‚¤ãƒ«URLï¼ˆGitHub Pagesï¼‰
        const VEGETATION_TILES = 'https://trilor.github.io/naruishi-map/{z}/{x}/{y}.png';

        // ãƒãƒƒãƒ—åˆæœŸåŒ–ï¼ˆOriLibreã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä½¿ç”¨ï¼‰
        const map = new maplibregl.Map({
            container: 'map',
            style: ORILIBRE_STYLE,
            center: CENTER,
            zoom: 15
        });

        map.addControl(new maplibregl.NavigationControl());
        map.addControl(new maplibregl.ScaleControl({ unit: 'metric' }));

        // ãƒãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾Œã«æ¤ç”Ÿãƒ¬ã‚¤ãƒ¤ã‚’è¿½åŠ 
        map.on('load', () => {
            // æ¤ç”Ÿã‚¿ã‚¤ãƒ«ã‚½ãƒ¼ã‚¹ã‚’è¿½åŠ 
            map.addSource('vegetation', {
                type: 'raster',
                tiles: [VEGETATION_TILES],
                tileSize: 256
            });

            // æ¤ç”Ÿãƒ¬ã‚¤ãƒ¤ã‚’è¿½åŠ ï¼ˆæœ€å‰é¢ï¼‰
            map.addLayer({
                id: 'vegetation-layer',
                type: 'raster',
                source: 'vegetation',
                paint: {
                    'raster-opacity': 0.6
                }
            });

            console.log('æ¤ç”Ÿãƒ¬ã‚¤ãƒ¤ã‚’è¿½åŠ ã—ã¾ã—ãŸ');
        });

        // æ¤ç”Ÿãƒ¬ã‚¤ãƒ¤è¡¨ç¤ºåˆ‡æ›¿
        document.getElementById('toggleVegetation').addEventListener('change', (e) => {
            if (map.getLayer('vegetation-layer')) {
                map.setLayoutProperty('vegetation-layer', 'visibility',
                    e.target.checked ? 'visible' : 'none');
            }
        });

        // é€æ˜åº¦èª¿æ•´
        document.getElementById('opacitySlider').addEventListener('input', (e) => {
            if (map.getLayer('vegetation-layer')) {
                map.setPaintProperty('vegetation-layer', 'raster-opacity',
                    parseInt(e.target.value) / 100);
            }
        });
    </script>
</body>

</html>